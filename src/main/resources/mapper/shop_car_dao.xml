<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="fzz.wsback.dao.ShopCarDao">

    <resultMap type="fzz.wsback.domain.ShopCarInfo"
               id="ShopCarResultMap">
        <id column="shop_car_id" property="shopCarId" jdbcType="INTEGER"/>
        <result column="user_id" property="userId" jdbcType="INTEGER"/>
        <result column="business_id" property="businessId" jdbcType="INTEGER"/>
        <result column="book_id" property="bookId" jdbcType="INTEGER"/>
        <result column="book_number" property="bookNumber" jdbcType="INTEGER"/>
    </resultMap>

    <!-- 根据前端信息插入数据到数据库表 -->
    <insert id="addItemToShopCar">
        insert into shop_car_info (user_id, business_id, book_id, book_number)
        values (#{userId}, #{businessId}, #{bookId}, #{bookNumber})
    </insert>

    <!-- 更新购物车中的book number信息-->
    <update id="updateBookNumber" parameterType="fzz.wsback.domain.ShopCarInfo">
        update shop_car_info
        set book_number = book_number + #{bookNumber}
        where shop_car_id = #{shopCarId};
    </update>

    <!-- 更新购物车中的book number信息-->
    <update id="updateBookNumber2" parameterType="fzz.wsback.domain.ShopCarInfo">
        update shop_car_info
        set book_number =  #{bookNumber}
        where shop_car_id = #{shopCarId};
    </update>

    <!-- 查找购物车表中信息通过user id-->
    <select id="getShopCarInfoByUserId" resultMap="ShopCarResultMap" parameterType="fzz.wsback.domain.ShopCarInfo">
        select *
        from shop_car_info
        where user_id = #{userId}
        order by shop_car_id
    </select>

    <!-- 删除购物车表项通过shopCarId   -->
    <delete id="deleteBookByShopCarId" parameterType="fzz.wsback.domain.ShopCarInfo">
        delete from shop_car_info
        where shop_car_id =  #{shopCarId}
    </delete>
</mapper>
